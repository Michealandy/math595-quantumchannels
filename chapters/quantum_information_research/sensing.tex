\documentclass[../../note.tex]{subfiles}

\begin{document}
This note is written by Zanqiu Shen from University of Toronto.

\chapter{Sensing}
\section{Quantum state distrimination with Bosonic channels aand Gaussian states}
This PhD thesis is written by Sihui Tan, who is the one that first propose Quantum Illumination. So this thesis is a very valuable material to learn QI.

\subsection{Mathematical preliminaries}
\begin{definition}[Direct sum of matrix]
    
\end{definition}



\subsection{Physics preliminaries}
\begin{lemma}[Eq. 2.23 in \cite{tan2010quantum}]
    \label{lemma: communtation relations}
    A system made of multiple harmonic oscillators is described by their annihilation operators,
    \begin{align}
        \hat{a}_{k},~k=1,\cdots,n.
    \end{align}
    They satisfy the canonical commutation relation
    \begin{align}
        [\hat{a}_k, \hat{a}_l^\dagger] = \delta_{kl}.
    \end{align}
\end{lemma}

\begin{lemma}[Eq. 2.27 in \cite{tan2010quantum}]
    The corresponding quadrature operators of a system made of multiple harmonic oscillators satisfy the canonical commutation relation
    \begin{align}
        [\hat{q}_k, \hat{p}_l] = \frac{i}{2} \delta_{kl}.
    \end{align}
\end{lemma}

\begin{lemma}
    We describe the phase space of the single bosonic modes with the vector
    \begin{align}
        \cR = (\hat{q}, \hat{p})^T,
    \end{align}
    so $\cR_1 = \hat{q}$ and $\cR_2 = \hat{p}$. Then we have
    \begin{align}
        [\cR_k, \cR_l]
        &= \frac{i}{2} \omega_{kl},
    \end{align}
    where 
    \begin{align}
        \omega
       &= \left[ \begin{matrix}
            0 & 1 \\
            -1 & 0
        \end{matrix}
        \right]
    \end{align}
    is the sympletic form of the phase space of single bosonic mode.
\end{lemma}

\begin{lemma}
    We describe the phase space of the $n$ bosonic modes with the vector
    \begin{align}
        \cR = (\hat{q}^1, \hat{p}^1, \cdots, \hat{q}^n, \hat{p}^n)^T.
    \end{align}
    We denote $\cR_1^i = \hat{q}^i$, $\cR_2^i = \hat{p}^i$, where $i$ denotes $i_{th}$ mode. Then we have
    \begin{align}
        [\cR_k^m, \cR_l^n]
        &= \frac{i}{2} \omega_{kl} \delta_{mn},
    \end{align}
    where 
    \begin{align}
        \omega
       &= \left[ \begin{matrix}
            0 & 1 \\
            -1 & 0
        \end{matrix}
        \right]
    \end{align}
    is the sympletic form of the phase space of single bosonic mode. Then the sympletic of $n$ bosonic modes is
    \begin{align}
        \Omega
        &= \bigoplus_{k=1}^n \omega,
    \end{align}
    where $\bigoplus$ denotes the direct sum.
\end{lemma}


\subsection{Introduction}


\subsection{Problem formulation}

\subsection{Protocol}

\subsection{Protocol Details}


\subsection{Performance evaluation}


\section{Joint Measurement of TFE via SFG \cite{liu2020joint}}
\subsection{Mathematical preliminaries}
\begin{proposition}[The Fourier Transform of 1]
    
\end{proposition}

\subsection{Physics preliminaries}
\begin{definition}[Sum Frequency Generation (SFG)]
The SFG process in a $\chi^{(2)}$ nonlinear medium could be modeled as the following evolution operator:
\begin{align}
    \label{evolution operator of sfg process}
    V
    &= I + \varepsilon\left(\int {\rm d}\omega_p {\rm d}\omega_s{\rm d}\omega_i a_p^\dagger(\omega_p)a_s(\omega_s)a_i(\omega_i)\delta(\omega_p - \omega_s - \omega_i) - H.C. \right),
\end{align}
where photons in the signal mode $a_s(\omega_s)$ and ideler mode $a_i(\omega_i)$ are annihilated to generate photons in the pump mode $a_p(\omega_p)$ and $\varepsilon$ characterizes the interaction strength. The SPDC process is the time-reversal process of SFG, which can also be described by the same revolution operator.
\end{definition}

\begin{definition}[SPDC]
    
\end{definition}

\begin{definition}[Evolution operator]
    
\end{definition}

\begin{theorem}[Schmidt' decomposition \cite{nielsen_chuang_2019}]
    
\end{theorem}

\begin{definition}[Schmidt's number \cite{nielsen_chuang_2019}]
    
\end{definition}

\begin{definition}[Heisenberg picture]
    
\end{definition}

\begin{proposition}[The relationship between annihilation operator and frequency]
    
\end{proposition}

\begin{definition}[Time Correlation]
    
\end{definition}

\begin{definition}[Frequency/Spectral/Energy Correlation]
    
\end{definition}


\subsection{Introduction}
SPDC is widely adopted to generate TFE photons. SFG can be used to perform TFE joint-measurement.

\SZQ{2023.06.03: TFE joint-measurement is just entangled measurement. SPDC is similart to unitary evolution for state preparation, in particular, the time-frequency entangled states. Thus, the reversed process SPDC, i.e., SFG process, is the entangled measurement. This is analogy to bell state preparation and bell measurements.}

\subsection{Problem formulation}
The frequency sum and time difference of two photons could be simultaneously measured through the sum-frequency generation process.

\subsection{Protocol}
Given the close connection between the spontaneous parametric down-conversion (SPDC) process and time-frequency entanglement (TFE), it's natural to utilize the time-reversal of the SPDC process, i.e., sum frequency generation (SFG) to obtain a TFE joint measurement based protocol.

\begin{definition}[Frequency sum (FS) operator]
    The frequency sum operator  $P_{\delta_{\omega}}(\omega)$ that selects states with the frequency sum $\omega_s + \omega_i$ of the signal and idler photon being around $\omega$ within uncertatinty $\delta_{\omega}$  is defined as:
    \begin{align}
        P_{\delta_{\omega}}(\omega)
        &= \int \int {\rm d}\omega_s{\rm d}\omega_i a_s^\dagger(\omega_s) a_i^\dagger(\omega_i) a_s(\omega_s) a_i(\omega_i) {\rm Gate}\left(\frac{\omega -\omega_s-\omega_i}{\delta_{\omega}}\right),
    \end{align}
    where ${\rm Gate}(x) = 1$ for $\vert x \vert \leq 1/2$ and ${\rm Gate}(x) = 0$ otherwise.
\end{definition}

\begin{lemma}[Frequency sum operator is a projection operator]
    The frequency sum operator  $P_{\delta_{\omega}}(\omega)$ is a projection operator satisfying
    \begin{align}
        P_{\delta_{\omega}}(\omega)^2
        &= P_{\delta_{\omega}}(\omega).
    \end{align}
\end{lemma}

\begin{definition}[Time difference (TD) operator]
    The time difference operator $P_{\delta_{t}}(t)$ that selects states with the time difference $t_s - t_i$ of the signal and idler photon being around $t$ within uncertatinty $\delta_{t}$  is defined as:
    \begin{align}
        P_{\delta_{t}}(t)
        &= \int \int {\rm d}t_s{\rm d}t_i \tilde{a_s}^\dagger(t_s) \tilde{a_i}^\dagger(t_i) \tilde{a_s}(t_s) \tilde{a_i}(t_i) {\rm Gate}\left(\frac{t_s -t_i-t}{\delta_{t}}\right),
    \end{align}
    where ${\rm Gate}(x) = 1$ for $\vert x \vert \leq 1/2$ and ${\rm Gate}(x) = 0$ otherwise and 
    \begin{align}
        \tilde{a}_x
        &= \frac{1}{\sqrt{2 \pi}} \int {\rm d}\omega \exp\left(-i\omega t\right)a_x(\omega)
    \end{align}
\end{definition}

\begin{lemma}[Time difference operator is a projection operator]
    The time difference operator  $P_{\delta_{t}}(t)$ is a projection operator satisfying
    \begin{align}
        P_{\delta_{t}}(t)^2
        &= P_{\delta_{t}}(t).
    \end{align}
\end{lemma}

\begin{definition}[Joint projection operator]
    The joint projection operator of the time difference and frequency sum is defined as
    \begin{align}
        P_{\delta_{\omega}, \delta_t}(\omega, t)
        &= P_{\delta_{\omega}}(\omega) P_{\delta_t}(t),
    \end{align}
    which means selecting states of which the time difference between the signal and idler photon $t_s -t_i$ is around $t$ within uncertainty $\delta_t$ and frequency sum of the signal and idler photon being around $\omega$ within unicertainty $\delta_{\omega}$, simultaneously.
\end{definition}

\begin{lemma}[Commutation relationship between frequency-time operators]
    We have the commutation relationship
    \begin{align}
        [P_{\delta_{\omega}}(\omega), P_{\delta_t}(t)] = 0.
    \end{align}
\end{lemma}

\begin{definition}[TD an FS probability density operator (PDF)]
    We define
    \begin{align}
        P(\omega, t)
        &= \lim_{\delta_t \rightarrow 0, \delta_{\omega} \rightarrow 0} \frac{1}{\delta_{\omega} \delta_{t}} P_{\delta_{\omega}}(\omega) P_{\delta_{t}}(t).
    \end{align}
\end{definition}

\begin{lemma}
    We have
    \begin{align}
        P(\omega, t)
        &= \frac{1}{2 \pi} B_p^\dagger B_p,
    \end{align}
    where
    \begin{align}
        B_p
        &= \int \int {\rm d}\omega_s{\rm d}\omega_i \delta(\omega_s+\omega_i-\omega) \exp\left[i \omega_i t\right] a_s(\omega_s) a_i(\omega_i).
    \end{align}
\end{lemma}

\begin{lemma}[Connection between TD and FS PDF and SFG Process]
    We have
    \begin{align}
        B^\dagger B
        &= 2 \pi P(\omega, 0).
    \end{align}
\end{lemma}
\textcolor{red}{This lemma did not show the SFG process}

\begin{lemma}[Discrete sum of evolution operator of SFG process]
    The discrete sum of the evolution operator of SFG process can be obtained by a \textbf{two-step Schmidt decomposition} as:
    \begin{align}
        v
        &= I + \varepsilon \sum_{m}\left(\sqrt{\lambda_m^{(1)}} A_m^\dagger B_m - H.C. \right),
    \end{align}
    where 
    \begin{align}
        B_m
        &= \sum_n \sqrt{\lambda_{m,n}^{(2)}} F_{m,n} G_{m,n}, \\
        A_m
        &= \int {\rm d}\omega \psi_{A,m}(\omega)a_p(\omega), \\
        B_m
        &= \int {\rm d}\omega_s{\rm d}\omega_i \psi_{B,m}(\omega_s, \omega_i) a_s(\omega_s)a_i(\omega_i), \\
        F_{m,n}
        &= \int{\rm d}\psi_{F,m,n}(\omega) a_s(\omega), \\
        G_{m,n}
        &= \int {\rm d}\psi_{G,m,n}(\omega)a_i(\omega).
    \end{align} 
\end{lemma}

\begin{lemma}[Non-uniqueness of the first step Schmidt Decomposition]
    If the function $f_0$ can be written in the following form:
    \begin{align}
        \delta(\omega_p - \omega_s -\omega_i) f_0(\omega_p -\omega_s -\omega_i)
        &= \delta(\omega_p - \omega_s - \Omega_i) f(\frac{\omega_s-\Omega_i}{\sqrt{2}}),
    \end{align}
    then the first step Schmidt decomposition in the main text is not unique.
\end{lemma}

\begin{lemma}[An useful communtation relationship]
    \label{lemma: an useful communtation relationship}
    An useful communtation relationship:
    \begin{align}
        [B_{m'},B^\dagger_{m''}]
        &= \delta_{m'm''} + \int {\rm d}\omega_s'{\rm d}\omega_i{\rm d}\omega_s''\psi^{\ast}_{B,m''}(\omega_s',\omega_i)a^\dagger_{s}(\omega_s'')a_s(\omega_s') \\
        &+\int {\rm d}\omega_s{\rm d}\omega_i'{\rm d}\omega_i''\psi^{\ast}_{B,m''}(\omega_s,\omega_i'')\psi_{B,m'}a^\dagger_{i}(\omega_i'')a_i(\omega_i').
    \end{align}
\end{lemma}

\begin{corollary}
    By (\ref{lemma: an useful communtation relationship}), we have
    \begin{align}
        [B_{m'},B_{m''}^\dagger]
        &= \delta_{m'm''} \vert 0 \rangle.
    \end{align}
\end{corollary}

\begin{lemma}
    We have the commutation relation between time difference projection operator and frequency sum projection operator:
    \begin{align}
        [P_{\delta_{\omega}}(\omega), P_{\delta_t}(t)]
        &= 0.
    \end{align}
\end{lemma}

\begin{lemma}
    The frequency spectrum $S(\omega)$ of the generated pump photon is given by the expectation value of the spectral density operator $a_p^\dagger(\omega_p)a_{p}(\omega_p)$ 
    \begin{align}
        S(\omega_p)
        &= \frac{\epsilon^2 \exp\left[\frac{1}{8}\left(-4 \Delta t^2 \sigma_-^2 - \frac{\Delta \omega^2}{\sigma_-^2} - \frac{4(\Delta \omega + \omega_0 - \Omega_p)^2}{\sigma_+^2} \right)\right]}{2 \sqrt{\pi} \sigma_+}.
    \end{align}
\end{lemma}

\begin{definition}
    The discrete mode operator $F_{m,n}^(b)$ for the noise photons is defined as
    \begin{align}
        F_{m,n}^{(b)}
        &= \int {\rm d}\omega \psi_{F_{m,n}}(\omega)a_s^{(b)}(\omega). 
    \end{align}
\end{definition}

\begin{definition}
    The virtual beam-splitter is modeledd as the following unitary transform:
    \begin{align}
        U_{loss}
        &= \Pi_{n} \exp\left[i {\rm arccos}(\eta)(F_{0,n}^\dagger F_{0,n}^{(b)} + H.C.)\right].
    \end{align}
\end{definition}

\begin{definition}
    We use a density matrix $\rho_b$ that satisfies the following conditions to describe the noise photons:
    \begin{align}
        \tr[F_{0,n''}^{(b) \dagger} F_{0,n'}^{(b)} \rho_b] 
        &= \delta_{n',n''} \mu_b, \\
        \tr[F_{0,n'}^{(b)} \rho_b]
        &= 0
    \end{align}
\end{definition}

\begin{definition}
    The signal and idler photon pair source is described by the biphoton state  $\vert pair \rangle$:
    \begin{align}
        \vert pair \rangle
        &= B_0^\dagger \vert 0 \rangle \\
        &= \sum_{n} \sqrt{\lambda_{0,n}^{(2)}} F_{0,n}^\dagger G_{0,n} \vert 0 \rangle.
    \end{align}
\end{definition}

\begin{definition}
    The unitary trasform of the SFG process is given by:
    \begin{align}
        V
        &= I + \epsilon \sum_{m} \left[\sqrt{\lambda_m^{(1)}} A_m^\dagger B_m - H.C. \right].
    \end{align}
\end{definition}

\begin{definition}
    In the Heisenberg picture, the photon number operator of the generated pump photon in each pump mode $A_m$ after the beam-splitter transform and the SFG process is given by:
    \begin{align}
        U^\dagger_{loss} V^\dagger A_{m}^\dagger V U_{loss}.
    \end{align}
\end{definition}

\begin{proposition}
    When the transmission of the signal photon is perfect ($\eta = 1$), the pump photon can only generate in mode $A_0 (m = 0)$.
\end{proposition}

\begin{lemma}
    We have
    \begin{align}
        \langle U^\dagger_{loss} V^\dagger A_0^\dagger A_0 V \vert U_{loss} \rangle
        &= \epsilon^2 \lambda_{0}^{(1)}(\eta + \mu_b \sum_n \lambda_{0,n}^2).
    \end{align}
\end{lemma}

\begin{definition}
    The generated SPDC state is given by:
    \begin{align}
        V
        &= \vert 0 \rangle - \epsilon \sqrt{\lambda_{0}^{(1)}} \alpha B_{0}^\dagger \vert 0 \rangle.
    \end{align}
\end{definition}

\begin{lemma}
    The joint density operator of the noise-idler state $\rho_j$ is given by the tensor product of $\rho_i$ and $\rho_b$:
    \begin{align}
        \rho_j 
        &= \rho_i \otimes \rho_b \\
        &= \mu_b \int \int {\rm d}\omega_s{\rm d}\omega_s' \int \int {\rm d}\omega_i'{\rm d}\omega_i''\phi_0^\ast(\omega_s', \omega_i') \phi_0(\omega_s', \omega_i'') a_i^\dagger(\omega_i') a_s^\dagger(\omega_s)\vert 0 \rangle \langle 0 \vert a_i(\omega_i'')a_s(\omega_s).
    \end{align}
\end{lemma}

\begin{lemma}
    The spectral density $S(\omega)$ of the upconverted photons is
    \begin{align}
        S(\omega)
        &= \frac{\epsilon^2 \mu_b \exp\left[-\frac{(\omega - \omega_0)^2}{8 \sigma_-^2 - 2 \sigma_+^2}\right]}{\sqrt{\pi} \sqrt{4 \sigma_-^2 + \sigma_+^2}}.
    \end{align}
\end{lemma}

\begin{theorem}
    The error exponent of the classical Chernoff bound of the TFE QI protocol is given by $C_{QI}$ \cite{nussbaum2009chernoff}:
    \begin{align}
        C_{QI}
        &= -\log~\min_{s \in [0,1]} \left\{\sum_{b \in 0,1}p_0(b)^s p_1(b)^{(1-s)}\right\}.
    \end{align}
\end{theorem}

\subsection{Performance evaluation}

\begin{lemma}
    \begin{align}
    \end{align}
\end{lemma}

\subsection{Ideas}

\section{Optimum Mixed-State Discrimination for Noisy Entanglement-Enhanced Sensing \cite{zhuang2017optimum}}
\subsection{Mathematical preliminaries}


\subsection{Physics preliminaries}


\subsection{Introduction}


\subsection{Problem formulation}


\subsection{Protocol}


\subsection{Protocol Details}


\subsection{Performance evaluation}

\begin{lemma}
    \begin{align}
    \end{align}
\end{lemma}

\subsection{Ideas}

\section{Quantum Estimation Methods for Quantum Illumination \cite{sanz2017quantum}}
\subsection{Mathematical preliminaries}
\begin{definition}[Quantum Fisher Information (QFI)]
    \label{dfe: qfi}
    Define a quantum state $\rho_{\eta}$ parameterized by $\eta$. Then the QFI for $\rho_{\eta}$ is
    \begin{align}
        H
        &:= 2 \sum_{mn} \frac{\vert \langle \phi_m \vert (\partial_{\eta}\rho_{\eta}\vert_{\eta=0}\vert \phi_{n}\rangle)\vert^2}{\lambda_m + \lambda_n},
    \end{align}
    where $\lambda_n$ is the eigenvalue of $\rho_{\eta=0}$ corresponding to the eigenstate $\vert \phi_n \rangle$, and the derivative is evaluated as $\eta=0$.
\end{definition}

\begin{definition}[Crame\'r-Rao Bound (CROB) in Eq. (2) \cite{sanz2017quantum}]
    \label{def: crob}
    The CROB asserts that the limits on the achievable precision of an unbiased estimator $\tilde{\eta}$ is
    \begin{align}
        \Delta \tilde{\eta}^2 \geq \frac{1}{MH},
    \end{align}
    where $H$ is the QFI (\ref{def: qfi}) of $\rho_{\eta}$ and $M$ is the number of copies. 
\end{definition}

\begin{theorem}[Cram\'er-Chernoff theorem \cite{hayashi2002two}]
    \label{thm: cct}
    
\end{theorem}

\begin{definition}[Matrix exponential from wiki]
    \label{def: matrix exponential}
    Let $X$ be an $n \otimes n$ real or complex matrix. The exponential of $X$, denoted by $e^X$ or $\exp[X]$, is the $n \times n$ matrix given by the power series
    \begin{align}
        e^X = \sum_{k=0}^{\infty} \frac{1}{k!} X^k,
    \end{align}
    where $X^0$ is defined to be the identity matrix $\id$ with the same dimensions as $X$. The series always converges, so the exponential of $X$ is well-defined.
\end{definition}

\begin{lemma}[Properties of matrix exponential]
    \label{lemma: properties of matrix exponential}
    Let $X$ and $Y$ be $n \times n$ complex matrices and let $a$ and $b$ be arbitrary complex numbers. We denote the $n \times n$ identity matrix by $\id$ and zero matrix by $0$. The matrix exponential satisfies the following properties:

    \textbf{Elementary properties:}
    \begin{itemize}
        \item $\exp[0] = \id$ \\
        \item $\exp[X^\dagger] = \exp[X]^\dagger$ \\
        \item If $[X, Y] = 0$, then $\exp[X] \exp[Y] = \exp[X + Y]$.
    \end{itemize}

    \textbf{The exponential map:}
    Define the map 
    \begin{align}
        t \mapsto \exp[t X],~ t \in \mathbb{R}.
    \end{align}

    We have
    \begin{itemize}
        \item \begin{align}
            \frac{d}{d t} e^{t X} = X e^{t X} = e^{t X} X.
        \end{align}
    \end{itemize}
\end{lemma}

\begin{lemma}[Geometric series]
    For $\vert x \vert < 1$, we have
    \begin{align}
        \sum_{n=0}^{\infty} x^n = \frac{1}{1 - x}.
    \end{align}
\end{lemma}

\begin{lemma}[Generalized geometric series]
    
\end{lemma}


\subsection{Physics preliminaries}


\subsection{Introduction}


\subsection{Problem formulation}
The quantum illumination problem is modeled as a \textbf{Reflectivity Estimation Problem} as the following.

Let us consider a general bipartite pure state representation of sinal-ideler system written in the Schmidt decomposition form
\begin{align}
    \vert \psi \rangle_{SI}
    &= \sum_{\alpha} \sqrt{p_{\alpha}} \vert w_{\alpha} \rangle_S \vert v_{\alpha} \rangle_I.
\end{align}

In the Quantum Illumimation (QI) protocol, the signal modes of $M$ copies of $\vert \psi \rangle_{SI}$ are sent to the target region embedded in a bright thermal noise, in which there could possibly be an object. We receive $M$ copies of the state
\begin{align}
    \rho_{\eta}
    &= \tr_S\left[U_{\eta} \psi \bigotimes \rho_B U_{\eta}^{\dagger}\right],
\end{align}
where 
\begin{align}
    U_{\eta}
    &:= \exp[\sin^{-1}(\eta) - s^\dagger b - s b^\dagger] \simeq \exp[\eta(s^\dagger b - s b^\dagger)]
    \label{def:U_eta}
\end{align}
is the signal-object interaction, modeled as a beamsplitter with amplitude reflectivity $\eta << 1$, and 
\begin{align}
\label{def: rho_B}
    \rho_B
    &:= \sum_n \frac{N_B^n}{(1+N_B)^{1+n}} \vert n \rangle \langle n \vert
\end{align} 
is the thermal state with mean photon number $N_B$.

In this framework, at the receiver side, $\eta=0$ corresponds to the absence of the object in the target region. We note $\eta$ is unknown parameter. So we measurement $\rho_{\eta}$ many times and get the estimation $\tilde{\eta}$. We then use $\hat{\eta}$ to determine whether is target is absent or present. This lie in the Estimation problem and state discrimination problem!

\subsection{Protocol}
The quantum illumination protocl has beed presented the last subsection. Here, we focus on the estimation protocol.

The main idea of the estimation protocol is to use QFI (\ref{def: qfi}) and CROB (\ref{def:crob}) for estimating $\eta$.

\begin{lemma}
    If a mode $s$ sent into a beamsplitter that has a thermal state input $b$ in the other port, then $U_{\eta} = \exp[\eta(s^\dagger b - s b^\dagger)]$ is indeed the unitary transformation.
    \label{lemma: unitary transformation}
\end{lemma}
\begin{proof}
    By the properties of matrix exponential \ref{def: matrix exponential}, we have
    \begin{align}
        U_{\eta}^{\dagger}
        &= \exp[\eta(s^\dagger b - s b^\dagger)]^\dagger \\
        &= \exp[\eta(b^\dagger s - b s^\dagger)].
    \end{align}
    Then we have
    \begin{align}
        U_{\eta} U_{\eta}^\dagger
        &= \exp\left[\eta(s^\dagger b - s b^\dagger + b^\dagger s - b s^\dagger)\right] \\
        &= \exp[\eta([s^\dagger, b] + [b^\dagger, s])] \\
        &\qquad\eqnote{By lemma \ref{lemma: communtation relations}} \nonumber \\
        &= \exp[\eta 0] \\
        &= \id.
    \end{align}
\end{proof}

\begin{lemma}
    The state $\rho_{\eta} = \tr_S \left[U_{\eta} \vert \psi\rangle \langle \psi \vert \otimes \rho_B U_{\eta}^{\dagger}\right]$, where $U_{\eta} \simeq \exp[\eta(s^\dagger b - s b^\dagger)]$. We have that the derivative computed at $\eta = 0$ is:
    \begin{align}
        \partial_{\eta} \rho_{\eta} = \tr_S[s^\dagger b - s b^\dagger, \vert \psi \rangle \langle \psi \vert \otimes \rho_B] = \sum_{\alpha \alpha^\prime} \sqrt{p_{\alpha} p_{\alpha'}} \vert v_{\alpha} \rangle \langle v_{\alpha} \vert \otimes \left[\langle w_{\alpha'} \vert s^\dagger \vert w_{\alpha} \rangle b - \langle w_{\alpha'} \vert s \vert w_{\alpha} \rangle b^\dagger, \rho_B \right].
    \end{align}
\end{lemma}
\begin{proof}
    \begin{align}
        \partial_{\eta} \rho_{\eta} \vert_{\eta=0}
        &= \tr_S\left[\partial_{\eta} U_{\eta} \vert \psi\rangle \langle \psi \vert \otimes \rho_B U_{\eta}^{\dagger}\right] \vert_{\eta=0} \\
        &= \tr_S\left[\partial_{\eta} \exp[\eta(s^\dagger b - s b^\dagger)] \vert \psi\rangle \langle \psi \vert \otimes \rho_B \exp[\eta(b^\dagger s - b s^\dagger)] \right] \vert_{\eta=0} \\
        &= \tr_S[ (s^\dagger b - s b^\dagger)\exp[\eta(s^\dagger b - s b^\dagger)] \vert \psi\rangle \langle \psi \vert \otimes \rho_B \exp[\eta(b^\dagger s - b s^\dagger)] +  \\
        &\exp[\eta(s^\dagger b - s b^\dagger)] \vert \psi\rangle \langle \psi \vert \otimes \rho_B \exp[\eta(b^\dagger s - b s^\dagger)](b^\dagger s - b s^\dagger) ]  \vert_{\eta=0}\\
        &= \tr_S[ (s^\dagger b - s b^\dagger) \vert \psi\rangle \langle \psi \vert \otimes \rho_B + \vert \psi\rangle \langle \psi \vert \otimes \rho_B (b^\dagger s - b s^\dagger) ]\\ 
        &= \tr_S[ (s^\dagger b - s b^\dagger) \vert \psi\rangle \langle \psi \vert \otimes \rho_B - \vert \psi\rangle \langle \psi \vert \otimes \rho_B (b s^\dagger - b^\dagger s) ]\\
        &\qquad\eqnote{By lemma \ref{lemma: communtation relations}} \nonumber \\
        &= \tr_S[ (s^\dagger b - s b^\dagger) \vert \psi\rangle \langle \psi \vert \otimes \rho_B - \vert \psi\rangle \langle \psi \vert \otimes \rho_B (s^\dagger b - s b^\dagger) ]\\
        &= \tr_S[s^\dagger b -s b^\dagger, \vert \psi \rangle \langle \psi \vert \otimes \rho_B].
    \end{align}
    Then we continue the derivation as
    \begin{align}
        &\tr_S\left[\vert \psi \rangle \langle \psi \vert \otimes \rho_B (s^\dagger b - s b^\dagger)\right]\\
        &= \tr\left[\vert \psi \rangle \langle \psi \rangle s^\dagger \otimes \rho_B b - \vert \psi \rangle \langle \psi \vert s \otimes \rho_B b^\dagger \right] \\
        &= \sum_k \langle w_k \vert \psi \rangle \langle \psi \vert s^\dagger \otimes \rho_B b \vert w_k \rangle - \sum_k \langle w_k \vert \psi \rangle \langle \psi \vert s \otimes \rho_B b \vert w_k \rangle \\
        &= \sum_{kij} \sqrt{p_i p_j} \langle w_k \vert \otimes I \vert w_i \rangle \langle w_j \vert \otimes \vert v_i \rangle \langle v_j \vert s^\dagger \otimes \id \vert w_k \rangle \otimes \id \otimes \rho_B b - \\
        &\sum_{kij} \sqrt{p_i p_j} \langle w_k \vert \otimes \id \vert w_i \rangle \langle w_j \vert \otimes \vert v_i \rangle \langle v_j \vert s \otimes \id \vert w_k \rangle \otimes \id \otimes \rho_B b^\dagger \\
        &= \sum_{kij} \sqrt{p_i p_j} \langle w_k \vert w_i \rangle \langle w_j \vert s^\dagger \vert w_k \rangle \otimes \vert v_i \rangle \langle v_j \vert \otimes \rho_B b - \\
        &\sum_{kij} \sqrt{p_i p_j} \langle w_k \vert w_i \rangle \langle w_j \vert s \vert w_k \rangle \otimes \vert v_i \rangle \langle v_j \vert \otimes  \rho_B b^\dagger \\
        &= \sum_{ij} \sqrt{p_i p_j} \langle w_j \vert s^\dagger \vert w_i \rangle \vert v_i \rangle \langle v_j \vert \otimes \rho_B b -
        \sum_{ij} \sqrt{p_i p_j} \langle w_j \vert s \vert w_i \rangle \vert v_i \rangle \langle v_j \vert \otimes  \rho_B b^\dagger \\
        &= \sum_{ij} \sqrt{p_i p_j} \vert v_i \rangle \langle v_j \vert \otimes \rho_B \langle w_j \vert s^\dagger \vert w_i \rangle b -
        \sum_{ij} \sqrt{p_i p_j}  \vert v_i \rangle \langle v_j \vert \otimes  \rho_B \langle w_j \vert s \vert w_i \rangle b^\dagger \\
        &= \sum_{ij} \sqrt{p_i p_j} \vert v_i \rangle \langle v_j \vert \otimes \rho_B \left[\langle w_j \vert s \vert w_i \rangle b^\dagger - \langle w_j \vert s^\dagger \vert w_i \rangle b \right].
    \end{align}
    Similarly, we can find that 
    \begin{align}
        &\tr_S\left[(s^\dagger b - s b^\dagger)\vert \psi \rangle \langle \psi \vert \otimes \rho_B\right]\\ 
        &= \sum_{ij} \left[\langle w_j \vert s^\dagger \vert w_i \rangle b - \langle w_j \vert s \vert w_i \rangle b^\dagger \right] \sqrt{p_i p_j} \vert v_i \rangle \langle v_j \vert \otimes \rho_B \\
        &= \sum_{ij} \sqrt{p_i p_j} \vert v_i \rangle \langle v_j \vert \otimes \left[\langle w_j \vert s^\dagger \vert w_i \rangle b - \langle w_j \vert s \vert w_i \rangle b^\dagger\right]\rho_B.
    \end{align}
    In summary, we have
    \begin{align}
        &\sum_{ij} \sqrt{p_i p_j} \vert v_i \rangle \langle v_j \vert \otimes \left[\left(\langle w_j \vert s^\dagger \vert w_i \rangle b - \langle w_j \vert s \vert w_i \rangle b^\dagger\right) \rho_B -  \left(\langle w_j \vert s \vert w_i \rangle b^\dagger - \langle w_j \vert s^\dagger \vert w_i \rangle b \right) \rho_B \right] \\
        &= \sum_{ij} \sqrt{p_i p_j} \vert v_i \rangle \langle v_j \vert \otimes \left[\left(\langle w_j \vert s^\dagger \vert w_i \rangle b - \langle w_j \vert s \vert w_i \rangle b^\dagger\right), \rho_B \right].
    \end{align}
\end{proof}

\begin{lemma}[$\rho_{\eta = 0}$]
    The family of states $\rho_{\eta}$ is derieved as
    \begin{align}
        \rho_{\eta = 0}
        &= \sum_{\alpha} p_{\alpha} \vert v_{\alpha} \rangle \langle v_{\alpha} \vert \otimes \sum_n \frac{N_B^n}{(1 + N_B)^{1 + n}} \vert n \rangle \langle n \vert = \sum_{\alpha n} p_{\alpha} \frac{N_B^n}{(1+N_B)^{1+n}} \vert v_{\alpha} n \rangle \langle v_{\alpha } n \vert.
    \end{align}
\end{lemma}
\begin{proof}
    Recall the definition of $\rho_B$ in \ref{def: rho_B}, and that 
    \begin{align}
        \rho_{\eta}
        &= \tr_S\left[U_{\eta} \psi \otimes \rho_B U_{\eta}^\dagger \right] \\
        &\qquad\eqnote{Use lemma \ref{lemma: unitary transformation}} \nonumber \\
        &= \tr_S\left[\exp[\eta (s^\dagger b -s b^{\dagger}) \psi \otimes \rho_B \exp[\eta(b^\dagger s - b s^\dagger)]] \right].
    \end{align}
    Then we have
    \begin{align}
        \rho_{\eta = 0}
        &= \tr_S\left[\psi \otimes \rho_B \right]  \\
        &= \tr_S\left[\psi_{SI} \rangle \langle \psi_{SI} \vert \otimes \rho_B \right] \\
        &= \tr_S\left[\sum_{\alpha \beta} \sqrt{p_{\alpha} p_{\beta}} \vert w_{\alpha} \rangle \langle w_{\beta} \vert \otimes \vert v_{\alpha} \rangle \langle v_{\beta} \vert \otimes \rho_B \right] \\
        &= \sum_{\alpha \beta} \sqrt{p_{\alpha} p_{\beta}} \langle w_{\beta} \vert w_{\alpha} \rangle \vert v_{\alpha}\rangle \langle v_{\beta} \vert \otimes \rho_B \\
        &= \sum_{\alpha} p_{\alpha} \vert v_{\alpha} \rangle \langle v_{\alpha} \vert \otimes \rho_B.
    \end{align}
    Substitute $\rho_B$ into $\rho_{\eta=0}$, we arrive at the final result.
\end{proof}

\begin{definition}
    The quantum fisher information for the family of states $\rho_{\eta}$ is defined as
    \begin{align}
        H
        &= 2 \sum_{mn} \frac{\vert \langle \phi_m \vert (\partial \rho_{\eta})\vert_{\eta = 0} \vert \phi_n \rangle \vert^2}{\lambda_m \lambda_n},
    \end{align}
    where $\lambda_n$ is the eigenvalue of $\rho_{\eta = 0}$ corresponding to the eigenstate $\vert \phi_n \rangle$, and the derivativeis evaluated at $\eta = 0$.
\end{definition}

\begin{lemma}
    Given the definition of $\rho_B$ \ref{def: rho_B}, we can compute the following four results:
    \begin{align}
        \langle n \vert b \rho_B \vert n^\prime \rangle 
        &= \rho_{n+1} \sqrt{n+1} \delta_{n+1, n^\prime} \\
        \langle n \vert b^\dagger \rho_B \vert n^\prime \rangle 
        &= \rho_{n^\prime} \sqrt{n^\prime + 1} \delta_{n, n^\prime + 1} \\
        \langle n \vert \rho_B b \vert n^\prime \rangle 
        &= \rho_n \sqrt{n+1} \delta_{n+1, n^\prime} \\
        \langle n \vert \rho_B b^\dagger \vert n \rangle 
        &= \rho_{n^\prime + 1} \sqrt{n^\prime + 1} \delta_{n, n^\prime + 1},
    \end{align}
    where $\rho_n = \frac{N_B^n}{(1 + N_B)^{1+n}}$.
\end{lemma}
\begin{proof}
    The first one:
    \begin{align}
        \langle n \vert b \rho_B \vert n^\prime \rangle 
        &= \langle n \vert b \sum_i \frac{N_B^i}{(1 + N_B)^{1+i}} \vert i \rangle \langle i \vert n^\prime \rangle \\
        &= \langle n \vert \sum_i \frac{N_B^i}{(1+N_B)^{1+i}} \sqrt{i} \vert i-1 \rangle \langle i \vert n^\prime \rangle \\
        &= \sum_i \frac{N_B^i}{(1 + N_B)^{1+i}} \sqrt{i} \langle n \vert i-1 \rangle \langle i \vert n^\prime \rangle \\
        &= \sum_i \frac{N_B^i}{(1 + N_B)^{1+i}} \sqrt{i} \delta_{n, i-1} \delta_{i, n^\prime} \\
        &= \frac{N_B^{n+1}}{(1 + N_B)^{1 + n+1}} \sqrt{n+1} \delta_{n+1, n^\prime} \\
        &= \rho_{n+1} \sqrt{n+1} \delta_{n+1, n^\prime}.
    \end{align}
    The second one:
    \begin{align}
        \langle n \vert b^\dagger \rho_B \vert n^\prime \rangle 
        &= \langle n \vert b^\dagger \sum_i \frac{N_B^i}{(1 + N_B)^{1+i}} \vert i \rangle \langle i \vert n^\prime \rangle \\
        &= \langle n \vert \sum_i \frac{N_B^i}{(1+N_B)^{1+i}} \sqrt{i+1} \vert i+1 \rangle \langle i \vert n^\prime \rangle \\
        &= \sum_i \frac{N_B^i}{(1 + N_B)^{1+i}} \sqrt{i+1} \langle n \vert i+1 \rangle \langle i \vert n^\prime \rangle \\
        &= \sum_i \frac{N_B^i}{(1 + N_B)^{1+i}} \sqrt{i+1} \delta_{n, i+1} \delta_{i, n^\prime} \\
        &= \sum_i \rho_i \sqrt{i+1} \delta_{n, i+1} \delta_{i, n^\prime} \\
        &= \rho_{n^\prime} \sqrt{n^\prime + 1} \delta_{n, n^\prime + 1}
    \end{align}
    The third one:
    \begin{align}
        \langle n \vert \rho_B b \vert n^\prime \rangle 
        &= \langle n \vert \sum_i \rho_i \vert i \rangle \langle i \vert b \vert n^\prime \rangle \\
        &= \langle n \vert \sum_i \rho_i \vert i \rangle (b^\dagger \vert i \rangle)^\dagger \vert n^\prime \rangle \\
        &= \langle n \vert \sum_i \rho_i \vert i \rangle (\sqrt{i+1} \vert i + 1\rangle)^\dagger \vert n^\prime \rangle \\
        &= \langle n \vert \sum_i \rho_i \vert i \rangle \langle i+1 \vert n^\prime \rangle \sqrt{i+1} \\
        &= \sum_i \rho_i \sqrt{i+1} \langle n \vert i \rangle \langle i+1 \vert n^\prime \rangle \\
        &= \sum_i \rho_i \sqrt{i+1} \delta_{n, i} \delta_{i+1, n^\prime}\\ 
        &= \rho_n \sqrt{n+1} \delta_{n+1, n^\prime}.
    \end{align}
    The fourth one:
    \begin{align}
        \langle n \vert \rho_B b^\dagger \vert n^\prime \rangle 
        &= \langle n \vert \sum_i \rho_i \vert i \rangle \langle i \vert b^\dagger \vert n^\prime \rangle \\
        &= \sum_i \rho_i \langle n \vert i \rangle \langle i \vert \sqrt{n^\prime + 1} \vert n^\prime + 1 \rangle \\
        &= \sum_i \rho_i \sqrt{n^\prime+1} \delta_{n, i} \delta_{i, n^\prime + 1} \\
        &= \rho_{n^\prime + 1} \sqrt{n^\prime + 1}\delta_{n, n^\prime + 1}.
    \end{align}
\end{proof}
\SZQ{Note that the resulting form can be different by apply $b$ or $b^\dagger$ in different direction.}

\begin{lemma}[Eq. (9) to Eq. (10)]
    We derive Eq. (10) from Eq. (9).
\end{lemma}
\begin{proof}
    We only need to focus on the numerator of the fraction 
    \begin{align}
        &\langle v_{\alpha}, n \vert \sum_{i j} \sqrt{p_i p_j} \vert v_i \rangle \langle v_j \vert \otimes \left[\langle w_j \vert s^\dagger \vert w_i \rangle b - \langle w_j \vert s \vert w_i \rangle  b^\dagger, \rho_B \right] \vert v_{\alpha^\prime}, n^\prime \rangle \\
        &= \sum_{ij} \sqrt{p_i p_j} \langle v_{\alpha}, n \vert v_i \rangle \langle v_j \vert \otimes \left[\langle w_j \vert s^\dagger \vert w_i \rangle b - \langle w_j \vert s \vert w_i \rangle b^\dagger, \rho_B \right] \vert v_{\alpha^\prime},n^\prime \rangle \\
        &= \sum_{ij} \sqrt{p_i p_j} \langle v_{\alpha} \vert v_i \rangle \langle v_j \vert v_{\alpha^\prime} \rangle \otimes \langle n \vert \left[\langle w_j \vert s^\dagger \vert w_i \rangle b - \langle w_j \vert s \vert w_i \rangle b^\dagger, \rho_B \right] \vert n^\prime \rangle \\
        &= \sqrt{p_{\alpha} p_{\alpha^{\prime}}} \langle n \vert \left[\langle w_j \vert s^\dagger \vert w_i \rangle b - \langle w_j \vert s \vert w_i \rangle b^\dagger, \rho_B \right] \vert n^\prime \rangle \\
        &=  \sqrt{p_{\alpha} p_{\alpha^{\prime}}} \langle n \vert \left[\langle w_j \vert s^\dagger \vert w_i \rangle b - \langle w_j \vert s \vert w_i \rangle b^\dagger, \rho_B \right] \vert n^\prime \rangle \\
        &= \sqrt{p_{\alpha} p_{\alpha^\prime}} \langle n \vert \left[ \langle w_j \vert s^\dagger \vert w_i \rangle b \rho_B - \langle w_j \vert s\vert w_i \rangle b^\dagger \rho_B - \langle w_j \vert s^\dagger \vert w_i \rangle \rho_B b + \langle w_j \vert s\vert w_i \rangle \rho_B b^\dagger  \right] \vert n^\prime \rangle \\
        &= \sqrt{p_{\alpha} p_{\alpha^\prime}} [\langle w_j \vert s^\dagger \vert w_i \rangle \langle n \vert b \rho_B \vert n^\prime \rangle - \langle w_j \vert s\vert w_i \rangle \langle n \vert b^\dagger \rho_B \vert n^\prime \rangle - \langle w_j \vert s^\dagger \vert w_i \rangle \langle n \vert \rho_B b \vert n^\prime \rangle \nonumber \\
        &+ \langle w_j \vert s\vert w_i \rangle \langle n \vert \rho_B b^\dagger \vert n^\prime \rangle ] \\
        &\qquad\eqnote{Use lemma } \nonumber \\
        &= 
    \end{align}
\end{proof}

\begin{lemma}[The QFI for the returned state $\rho_{\eta}$ in Eq. (3) \cite{sanz2017quantum}]
    \label{lemma: qfi of returned state}
    The QFI for $\rho_{\eta}$ is
    \begin{align}
        H
        &:= \frac{4}{1+N_B} \sum_{\alpha \alpha^\prime} \frac{p_\alpha p_{\alpha^\prime}}{p_{\alpha^\prime} + p_{\alpha} \frac{N_B}{1+N_B}} \vert \langle w_{\alpha^\prime} \vert s \vert w_{\alpha} \rangle \vert^2.
    \end{align}
\end{lemma}
\begin{proof}
    
\end{proof}

We choose the observable that optimize the QFI of the returned state (\ref{{lemma: qfi of returned state}}) and measure $\rho_{\eta}$, the outcome is $o_i$. Then by the strong law of large numbers, we perform the sample mean as
\begin{align}
    \label{eq: estimation of eta}
    \tilde{\eta}
    &= \frac{1}{M} \sum_{i=1}^{M} o_i.
\end{align}

\begin{algorithm}[H]
    \caption{QI estimation protocol}
    \label{ptl: quantum illumination estimation protocol}
    \begin{algorithmic}[1]
    \REQUIRE $\vert \psi_{SI} \rangle$: the signal-idler state, \\
    \hskip1.4em $\eta$: the reflectivity parameter,\\
    \hskip1.4em $\rho_B$: the thermal state \\
    \hskip1.4em $M$: the number of copies of $\vert \psi_{SI} \rangle$ \\
    \ENSURE Estimation of the reflectivity $\tilde{\eta}$.  
    \FOR{$i = 1, \cdots, M$}
    \STATE Sent the signal mode of $ \psi_{SI}^{(1)}$ to the target region,
    \STATE Rceive the state $\rho_{\eta}^{(1)}$,
    \STATE \textbf{Choose the observable that optimize the QFI},
    \STATE Measure the observable and get the outcome $o_i$.
    \ENDFOR
    \STATE Calculate $\tilde{\eta} (\ref{eq: estimation of eta})$.
    \STATE Output the estimated reflectivity parameter $\tilde{\eta}$.
    \end{algorithmic}
\end{algorithm}

After that, we use the estimation $\tilde{\eta}$ for state discrimination.


\begin{algorithm}[H]
    \caption{QI discrimination protocol}
    \label{ptl: quantum illumination discrimination protocol}
    \begin{algorithmic}[1]
    \REQUIRE $\tilde{\eta}$: the estimation reflectivity, \\
    \hskip1.4em $\xi$: the scaling parameter.\\
    \ENSURE Absent or present.  
    \IF{$\tilde{\eta} > \xi \eta$}
        \STATE Output present.
    \ELSIF{$\tilde{\eta} \leq \xi \eta$}
        \STATE Output absent.
    \ELSE
        \STATE Output 'Wrong input!'
    \ENDIF
    \end{algorithmic}
\end{algorithm}

\subsection{Protocol Details}


\subsection{Performance evaluation}
\begin{theorem}[Type I-II error probabilities Theorem in \cite{sanz2017quantum}]
    Let $\vert \psi \rangle_{SI} = \sqrt{p_\alpha}\vert n \rangle_S \vert v_n \rangle_I$ be the Schmidt decomposition of the signal-idler state, and denote $\rho_S$ the state of the signal. Then $P_{I, II} \sim \exp\left(-\frac{\eta_{I, II}^2 H M}{2}\right)$ provided that $\exists C >0$ s.t. $\langle s^k s^{\dagger k} \rangle_{\rho_S} \leq k !C^k, \forall k \in \cN$.
\end{theorem}
\begin{proof}
    
\end{proof}

\subsection{Exapmles}
\begin{example}[Gaussian states]
 
\end{example}

\begin{example}[Schr\"{o}dinger's cat state]
 
\end{example}

\subsection{Main ideas summarized}
This subsection summarizes the main ideas in this paper.

Choose the observable that optimize the QFI.


\subsection{Ideas}
How many copies of $\psi_{SI}$ is needed to achieve a given confidence interval? This is a problem about the quantum resources?



\addcontentsline{toc}{section}{References}
\bibliographystyle{alpha}
\bibliography{../../references}

\end{document}